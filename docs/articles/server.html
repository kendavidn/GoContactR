<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>02: server.R • GoContactR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="02: server.R">
<meta property="og:description" content="GoContactR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GoContactR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/06_video_walkthroughs.html">06: Video walkthroughs</a>
    </li>
    <li>
      <a href="../articles/global.html">01: global.R</a>
    </li>
    <li>
      <a href="../articles/report.html">05_report.Rmd</a>
    </li>
    <li>
      <a href="../articles/server.html">02: server.R</a>
    </li>
    <li>
      <a href="../articles/server_functions.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/server_functions_for_CIV.html">03.1: server_functions_for_CIV.R</a>
    </li>
    <li>
      <a href="../articles/server_functions_for_UGA.html">03.2 server_functions_for_UGA.R</a>
    </li>
    <li>
      <a href="../articles/ui.html">04: ui.R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kendavidn/GoContactR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
        
        


      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="server_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>02: server.R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kendavidn/GoContactR/blob/master/vignettes/server.Rmd"><code>vignettes/server.Rmd</code></a></small>
      <div class="hidden name"><code>server.Rmd</code></div>

    </div>

    
    
<p>Increase upload size. See <a href="https://shiny.rstudio.com/articles/upload.html" class="uri">https://shiny.rstudio.com/articles/upload.html</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>shiny.maxRequestSize <span class="op">=</span> <span class="fl">50</span> <span class="op">*</span> <span class="fl">1024</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div id="source-server-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#source-server-functions" class="anchor"></a>Source server functions</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~  Source server functions ------------------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Load in the primary functions that will be called within server.R</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"helper_scripts/server_functions.R"</span><span class="op">)</span>, local <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-data-reactives" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data-reactives" class="anchor"></a>Load data reactives</h1>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~  Load data reactives --------------------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Each of the “read_file-” reactives sources its namesake function. These functions are called in a reactive context to ensure that if the input data changes, all the output graphs will change as well. ## read_file_raw_reactive</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ read_file_raw_reactive --------------------</span></code></pre></div>
<p>The read_file_raw function does either of two things. - For countries using Go.Data, it takes in the input credentials, logs into a Go.Data session, and returns a list with the requisite dataframes. - For countries using KoboCollect, it takes in the two uploaded csv files, (contact list and follow-up list), and returns them as a list of a dataframes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">read_file_raw_reactive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>

    <span class="fu">read_file_raw</span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="read_file_transformed_reactive" class="section level2">
<h2 class="hasAnchor">
<a href="#read_file_transformed_reactive" class="anchor"></a>read_file_transformed_reactive</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ read_file_transformed_reactive -----------------</span></code></pre></div>
<p>The ‘read_file_transformed’ function takes in data from read_file_raw_reactive, and ‘transforms’ it into a single, ‘long’ dataframe, with one row per contact-follow-up-day</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">read_file_transformed_reactive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>

    <span class="fu">read_file_transformed</span><span class="op">(</span>tracing_data_raw <span class="op">=</span> <span class="fu">read_file_raw_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>


  <span class="co">#' ## read_file_filtered_reactive</span>
  <span class="co"># ~~~~ read_file_filtered_reactive ------------------------</span>
  <span class="co">#' The 'read_file_filtered' function takes in data from read_file_transformed_reactive </span>
  <span class="co">#' It also takes in a date_of_review variable.</span>
  <span class="co">#' It filters out contacts who had not begun followup by the selected date_of_review </span>
  <span class="co">#' Also, for contacts being followed, "future" are relabelled as such. </span>
  <span class="co">#' The output of read_file_filtered is a df that feed most graphs in the app. </span>

  <span class="va">read_file_filtered_reactive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>

    <span class="fu">read_file_filtered</span><span class="op">(</span>contacts_df_long_transformed <span class="op">=</span> <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span>, 
                       todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="action-button-observer" class="section level1">
<h1 class="hasAnchor">
<a href="#action-button-observer" class="anchor"></a>Action button observer</h1>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~  Action button observer ---------------------------</span></code></pre></div>
<p>This observer simply triggers or re-triggers ‘read_file_transformed_reactive’ whenever the analyze action button is pressed</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span>, <span class="op">{</span>
    <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="data-overview-section" class="section level1">
<h1 class="hasAnchor">
<a href="#data-overview-section" class="anchor"></a>Data overview section</h1>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~  Data overview section----</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>The plots below take in data from ‘read_file_transformed_reactive’ and output summary graphics. Recall that the output of ‘read_file_transformed_reactive’ is the unfiltered, full, “long” dataframe, with one row per contact-follow-up-day. ## data_completeness_plot</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ data_completeness_plot ---------------------------</span></code></pre></div>
<p>Here we output a visualization of the entire long dataframe. Uses the viz_dat function</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">output</span><span class="op">$</span><span class="va">data_completeness_plot</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

      <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span> <span class="op">==</span> <span class="st">"Use uploaded data"</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">uploaded_data_contacts_list</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">uploaded_data_follow_up_list</span><span class="op">)</span>
      <span class="op">}</span>

      <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span> <span class="op">==</span> <span class="st">"Use preloaded data"</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">preloaded_data_choice</span><span class="op">)</span>
      <span class="op">}</span>

      <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">data_completeness_plot</span><span class="op">(</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="data_cardinality_plot" class="section level2">
<h2 class="hasAnchor">
<a href="#data_cardinality_plot" class="anchor"></a>data_cardinality_plot</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~  data_cardinality_plot ---------------------------</span></code></pre></div>
<p>This is a plot using the ‘inspect_cat’ function of the inspectdf package</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">output</span><span class="op">$</span><span class="va">data_cardinality_plot</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

      <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span> <span class="op">==</span> <span class="st">"Use uploaded data"</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">uploaded_data_contacts_list</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">uploaded_data_follow_up_list</span><span class="op">)</span>
      <span class="op">}</span>

      <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span> <span class="op">==</span> <span class="st">"Use preloaded data"</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">preloaded_data_choice</span><span class="op">)</span>
      <span class="op">}</span>

      <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">data_cardinality_plot</span><span class="op">(</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="reactable_table" class="section level2">
<h2 class="hasAnchor">
<a href="#reactable_table" class="anchor"></a>reactable_table</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ reactable_table ---------------------------</span></code></pre></div>
<p>Here, we output the entire long table for easy viewing, or searching</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">output</span><span class="op">$</span><span class="va">reactable_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable-shiny.html">renderReactable</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

      <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span> <span class="op">==</span> <span class="st">"Use uploaded data"</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">uploaded_data_contacts_list</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">uploaded_data_follow_up_list</span><span class="op">)</span>
      <span class="op">}</span>

      <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span> <span class="op">==</span> <span class="st">"Use preloaded data"</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">preloaded_data_choice</span><span class="op">)</span>
      <span class="op">}</span>

      <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">reactable_table</span><span class="op">(</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="date-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#date-selection" class="anchor"></a>Date selection</h1>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~  Date selection --------------------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>This tab contains the primary graphs and tables that pertain to all contacts. (The next tab contains information pertaining to only active contacts, that is, contacts who are actively under surveillance) ## select_date_of_review</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ select_date_of_review --------------------</span></code></pre></div>
<p>This picker lets you select a present or historical date, letting you see what the data looked like at each time point. The range of dates that can be picked are bounded by the range of dates in the dataframe (passed from ‘read_file_transformed_reactive’). The picker also guesses what the date of review is. Basically, it obtains the last date for which follow-up status was not “missing” or “future”, (the last day on which there was any contact follow-up), and assumes this is the date on which the user would like to view the data.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">output</span><span class="op">$</span><span class="va">select_date_of_review</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    
    <span class="co">## date selection needs to use the unfiltered data frame</span>
    <span class="co">## because the selection from this input feeds the filtering function</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data_to_use</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    
    
    <span class="va">flattened_dates</span> <span class="op">&lt;-</span>
      <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">follow_up_date</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">pull</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
    
    <span class="va">min_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">flattened_dates</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
    <span class="va">max_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">flattened_dates</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
    
    <span class="co"># get the last date for which follow-up status was not "missing" or "future"</span>
    <span class="co"># assume that that is the date as on which the data is being analyzed</span>
    <span class="va">todays_date_imputed_from_data</span> <span class="op">&lt;-</span>
      <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">follow_up_status</span> <span class="op">!=</span> <span class="st">"Suivi futur"</span> <span class="op">&amp;</span>
               <span class="va">follow_up_status</span> <span class="op">!=</span> <span class="st">"Manquant"</span> <span class="op">&amp;</span>
               <span class="va">follow_up_status</span> <span class="op">!=</span> <span class="st">"Future follow-up"</span> <span class="op">&amp;</span>
               <span class="va">follow_up_status</span> <span class="op">!=</span> <span class="st">"NA"</span> <span class="op">&amp;</span>
               <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">follow_up_status</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">follow_up_date</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">pull</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/dateInput.html">dateInput</a></span><span class="op">(</span><span class="st">"select_date_of_review"</span>,
              label <span class="op">=</span> <span class="st">"Select date of review"</span>,
              value <span class="op">=</span> <span class="va">todays_date_imputed_from_data</span>,
              min <span class="op">=</span> <span class="va">min_date</span>,
              max <span class="op">=</span> <span class="va">max_date</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="generate-downloadable-report" class="section level1">
<h1 class="hasAnchor">
<a href="#generate-downloadable-report" class="anchor"></a>Generate downloadable report</h1>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~  Generate downloadable report --------------------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<div id="select_report_format" class="section level2">
<h2 class="hasAnchor">
<a href="#select_report_format" class="anchor"></a>select_report_format</h2>
<p>Select which of five formats to use for the downloaded report. (As at May 13, 2021, the PDF format is not working. Should hopefully work when this issue is sorted by the RStudio team: <a href="https://bit.ly/3oj0Kkv" class="uri">https://bit.ly/3oj0Kkv</a> )</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ select_report_format---------------------------</span>
  <span class="va">output</span><span class="op">$</span><span class="va">select_report_format</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"report_format"</span>,
                label <span class="op">=</span> <span class="st">"Select format"</span>,
                choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                  <span class="st">"pptx"</span>,
                  <span class="st">"docx"</span>,
                  <span class="co">#"pdf",</span>
                  <span class="st">"html (page)"</span>,
                  <span class="st">"html (slides)"</span>
                <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="download_report_button" class="section level2">
<h2 class="hasAnchor">
<a href="#download_report_button" class="anchor"></a>download_report_button</h2>
<p>This is placed within a renderUI context so that we can hide it conditionally</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ download_report_button---------------------------</span>
  <span class="va">output</span><span class="op">$</span><span class="va">download_report_button</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="st">"&lt;p style='font-size:4px'&gt;  &lt;br&gt;&lt;br&gt;  &lt;/p&gt;"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/shinyWidgets/man/downloadBttn.html">downloadBttn</a></span><span class="op">(</span><span class="st">"report"</span>,
                   label <span class="op">=</span> <span class="st">"Download report"</span>,
                   style <span class="op">=</span> <span class="st">"jelly"</span>,
                   color <span class="op">=</span> <span class="st">"primary"</span>, size <span class="op">=</span> <span class="st">"md"</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="download_report_function" class="section level2">
<h2 class="hasAnchor">
<a href="#download_report_function" class="anchor"></a>download_report_function</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ download_report_function---------------------------</span>

<span class="va">output</span><span class="op">$</span><span class="va">report</span> <span class="op">&lt;-</span> <span class="fu">download_report_function</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="dynamic-filtering-section" class="section level1">
<h1 class="hasAnchor">
<a href="#dynamic-filtering-section" class="anchor"></a>Dynamic filtering section</h1>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~  Dynamic filtering section --------------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<div id="filters" class="section level2">
<h2 class="hasAnchor">
<a href="#filters" class="anchor"></a>filters</h2>
<p>A dynamic filtering section. The code below renders an input picker for each column in the dataset. The code is quite hairy, but we have tried to comment it extensively.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ ouput$filters----</span>

<span class="va">cols_to_exclude_from_filters</span> <span class="op">&lt;-</span> 
  <span class="co">## filters not created for rows that change across each contact</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"follow_up_date"</span>, <span class="st">"follow_up_day"</span>, 
    <span class="st">"follow_up_status"</span>, <span class="st">"follow_up_status_simple"</span>,
    <span class="co">## no filters for synthetic columns either</span>
    <span class="st">"row_id"</span>,<span class="st">"row_number"</span>,<span class="st">"sort_number"</span>, 
    <span class="co">## and no filters on names. </span>
    <span class="co">## Franck mentioned not printing names to app for privacy</span>
    <span class="st">"first_name"</span>, <span class="st">"last_name"</span><span class="op">)</span>

  <span class="va">output</span><span class="op">$</span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">filter_or_not</span><span class="op">)</span>

    <span class="co">## filters are only generated if the filter_or_not slider is set to TRUE</span>
    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">filter_or_not</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">input</span><span class="op">$</span><span class="va">filter_or_not</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
      
      <span class="va">my_data</span> <span class="op">&lt;-</span>
        <span class="fu">read_file_transformed_reactive</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">## not sure why but tibble doesn't work</span>
        <span class="co">## filters not created for rows that change across each contact</span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu">any_of</span><span class="op">(</span><span class="va">cols_to_exclude_from_filters</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="co">## no filters for columns that are all NA</span>
        <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/remove_empty.html">remove_empty</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"cols"</span><span class="op">)</span>
      
      
      <span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span><span class="op">)</span>
      
      
      <span class="co">## unique values of each column</span>
      <span class="va">choices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">[</span>, <span class="va">labels</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
      <span class="op">}</span><span class="op">)</span>
      

      <span class="co">## render a selector for each column</span>
      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
        
        <span class="co">## create output$gender, output$region and so on based on column names</span>
        <span class="va">output</span><span class="op">[[</span><span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
          
          <span class="co">## first subset the data to that column</span>
          <span class="va">col</span> <span class="op">&lt;-</span> <span class="va">my_data</span><span class="op">[</span>, <span class="va">labels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
          
          <span class="co">## then, below, we render an input picker based on whether the column is a character, number or date</span>
          <span class="co">## and also based on whether or not the column has NA values</span>
          
          <span class="co">## CHARACTER AND FACTOR COLUMNS  ~~~~~~~~~~~~~~~~~~~</span>
          <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            
            <span class="co">## calc unique length to decide whether to add search bar</span>
            <span class="va">length_choices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">choices</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
            <span class="va">search_or_not</span> <span class="op">&lt;-</span> <span class="kw">if</span><span class="op">(</span><span class="va">length_choices</span> <span class="op">&gt;=</span> <span class="fl">10</span> <span class="op">)</span> <span class="cn">TRUE</span> <span class="kw">else</span> <span class="cn">FALSE</span>
            
            <span class="co">## create pickerInput. </span>
            <span class="co">## this would be accessed as input$gender, input$region and so on</span>
            <span class="va">input_UI_element</span> <span class="op">&lt;-</span>  
              <span class="fu"><a href="https://rdrr.io/pkg/shinyWidgets/man/pickerInput.html">pickerInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                          label <span class="op">=</span> <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                          choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">choices</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
                          selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">choices</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
                          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`actions-box` <span class="op">=</span> <span class="cn">TRUE</span>, 
                                         `virtual-scroll`   <span class="op">=</span> <span class="cn">TRUE</span>, 
                                         `live-search` <span class="op">=</span> <span class="va">search_or_not</span>,
                                         `live-search-placeholder` <span class="op">=</span> <span class="st">"Enter search term"</span>,
                                         `dropup-auto` <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
                          multiple <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
            <span class="co">## if col has NA values, add checkboxinput asking whether to keep these</span>
            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
              <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
                <span class="va">input_UI_element</span>, 
                <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/checkboxInput.html">checkboxInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"na_"</span>, <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
                              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Include contacts w. missing values for "</span>,
                                             <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="st">"?"</span><span class="op">)</span>,
                              value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
              <span class="co">## otherwise, print/return just the primary input picker</span>
              <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="va">input_UI_element</span> <span class="op">}</span>
            
            
            <span class="co">## NUMERIC COLUMNS  ~~~~~~~~~~~~~~~~~~~</span>
            <span class="co">## same procedure as with character columns</span>
          <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">input_UI_element</span> <span class="op">&lt;-</span> 
              <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">sliderInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                          label <span class="op">=</span> <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                          min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                          max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                          value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
                                    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
            <span class="co">## if col has NA values, add checkboxinput asking whether to keep these</span>
            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
              <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
                <span class="va">input_UI_element</span>, 
                <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/checkboxInput.html">checkboxInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"na_"</span>, <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
                              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Include contacts w. missing values for "</span>,
                                             <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="st">"?"</span><span class="op">)</span>,
                              value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
              <span class="co">## otherwise, print/return just the primary input picker</span>
            <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="va">input_UI_element</span> <span class="op">}</span>
            
            
            <span class="co">## DATE COLUMNS  ~~~~~~~~~~~~~~~~~~~</span>
          <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/date_utils.html">is.Date</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">input_UI_element</span> <span class="op">&lt;-</span> 
              <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/dateRangeInput.html">dateRangeInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                             label <span class="op">=</span> <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                             min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                             max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                             start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                             end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">col</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
            <span class="co">## if col has NA values, add checkboxinput asking whether to keep these</span>
            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
              <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
                <span class="va">input_UI_element</span>, 
                <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/checkboxInput.html">checkboxInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"na_"</span>, <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
                              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Include contacts w. missing values for "</span>,
                                             <span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="st">"?"</span><span class="op">)</span>,
                              value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
              <span class="co">## otherwise, print/return just the primary input picker</span>
            <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="va">input_UI_element</span> <span class="op">}</span>
            
          <span class="op">}</span>
          <span class="op">}</span><span class="op">)</span>
        
      <span class="op">}</span>
      <span class="op">)</span>
            

      <span class="co">## the large lapply function above created an input picker for each column</span>
      <span class="co">## now we output all those input pickers, </span>
      <span class="co">## as in uiOutput("gender") and so on.</span>
      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">uiOutput</a></span><span class="op">(</span><span class="va">labels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
        <span class="op">}</span><span class="op">)</span>
    <span class="op">}</span>
    
    <span class="co">## these uiOutputs are packaged into a larger output, output$filters, </span>
    <span class="co">## which will, finally, be placed in our UI, as in uiOutput("filters")</span>
  <span class="op">}</span><span class="op">)</span>

  <span class="va">output</span><span class="op">$</span><span class="va">additional_filters_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">filter_or_not</span><span class="op">)</span>

    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">filter_or_not</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">input</span><span class="op">$</span><span class="va">filter_or_not</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h6</a></span><span class="op">(</span><span class="st">"Use the input pickers and sliders to filter your data"</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="st">"&lt;font size='1'&gt;
            Note that the following are not shown: &lt;br&gt;
          • Empty columns; &lt;br&gt;
          • Name columns; and &lt;br&gt;
          • the date of follow-up column &lt;br&gt;
          Also note that the options for each filter 
          do not react to selections on other filters.
                               &lt;/font&gt;"</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="outputs-pertaining-to-all-contacts" class="section level1">
<h1 class="hasAnchor">
<a href="#outputs-pertaining-to-all-contacts" class="anchor"></a>OUTPUTS PERTAINING TO ALL CONTACTS</h1>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ OUTPUTS PERTAINING TO ALL CONTACTS ----</span>
<span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
</div>
<div id="value-boxes" class="section level1">
<h1 class="hasAnchor">
<a href="#value-boxes" class="anchor"></a>Value boxes</h1>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Value boxes  --------------------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Below we call the value-box functions and return their outputs. These functions return an HTML Shiny value-box when the report_format parameter is “shiny”, and a ggplot-based value-box otherwise. Like most of the remaining functions that the app uses, these take in two primary inputs: the long contacts dataframe (one row per follow-up-day), and the date of review. ## contacts_per_day_value_box</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ contacts_per_day_value_box ----</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">contacts_per_day_value_box</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shinydashboard/man/renderValueBox.html">renderValueBox</a></span><span class="op">(</span><span class="op">{</span>
      
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>
      
      <span class="co">## require that there is actually data to be visualized</span>
      <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">need</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

      <span class="fu">contacts_per_day_value_box</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="cumulative_contacts_value_box" class="section level2">
<h2 class="hasAnchor">
<a href="#cumulative_contacts_value_box" class="anchor"></a>cumulative_contacts_value_box</h2>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ cumulative_contacts_value_box ----</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">cumulative_contacts_value_box</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shinydashboard/man/renderValueBox.html">renderValueBox</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>
      <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">need</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

      <span class="fu">cumulative_contacts_value_box</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="contacts_under_surveillance_value_box" class="section level2">
<h2 class="hasAnchor">
<a href="#contacts_under_surveillance_value_box" class="anchor"></a>contacts_under_surveillance_value_box</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ contacts_under_surveillance_value_box ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">contacts_under_surveillance_value_box</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shinydashboard/man/renderValueBox.html">renderValueBox</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>
      <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">need</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

      <span class="fu">contacts_under_surveillance_value_box</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="pct_contacts_followed_value_box" class="section level2">
<h2 class="hasAnchor">
<a href="#pct_contacts_followed_value_box" class="anchor"></a>pct_contacts_followed_value_box</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ pct_contacts_followed_value_box ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">pct_contacts_followed_value_box</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shinydashboard/man/renderValueBox.html">renderValueBox</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">analyze_action_bttn</span><span class="op">)</span>
      <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html">need</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

      <span class="fu">pct_contacts_followed_value_box</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="contacts-per-region" class="section level1">
<h1 class="hasAnchor">
<a href="#contacts-per-region" class="anchor"></a>Contacts per region</h1>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Contacts per region  --------------------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Below we call the contacts_per_admin_1 functions. These show the distribution of contacts over admin level 1 and admin level 2. ## all_contacts_per_admin_1_table</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ all_contacts_per_admin_1_table ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">all_contacts_per_admin_1_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable-shiny.html">renderReactable</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">all_contacts_per_admin_1_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="all_contacts_per_admin_1_sunburst_plot" class="section level2">
<h2 class="hasAnchor">
<a href="#all_contacts_per_admin_1_sunburst_plot" class="anchor"></a>all_contacts_per_admin_1_sunburst_plot</h2>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ all_contacts_per_admin_1_sunburst_plot ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">all_contacts_per_admin_1_sunburst_plot</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">all_contacts_per_admin_1_sunburst_plot</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="all_contacts_per_admin_1_bar_chart" class="section level2">
<h2 class="hasAnchor">
<a href="#all_contacts_per_admin_1_bar_chart" class="anchor"></a>all_contacts_per_admin_1_bar_chart</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ all_contacts_per_admin_1_bar_chart ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">all_contacts_per_admin_1_bar_chart</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">all_contacts_per_admin_1_bar_chart</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="all_contacts_per_admin_1_text" class="section level2">
<h2 class="hasAnchor">
<a href="#all_contacts_per_admin_1_text" class="anchor"></a>all_contacts_per_admin_1_text</h2>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ all_contacts_per_admin_1_text ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">all_contacts_per_admin_1_text</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">all_contacts_per_admin_1_text</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="contacts-surveilled-over-time" class="section level1">
<h1 class="hasAnchor">
<a href="#contacts-surveilled-over-time" class="anchor"></a>Contacts surveilled over time</h1>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Contacts surveilled over time  -----------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Functions showing how many contacts were under surveillance at each time point, segregated by region. ## contacts_surveilled_admin_1_bar_chart</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ contacts_surveilled_admin_1_bar_chart ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">contacts_surveilled_admin_1_bar_chart</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">contacts_surveilled_admin_1_bar_chart</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="contacts_surveilled_admin_1_bar_chart_relative" class="section level2">
<h2 class="hasAnchor">
<a href="#contacts_surveilled_admin_1_bar_chart_relative" class="anchor"></a>contacts_surveilled_admin_1_bar_chart_relative</h2>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ contacts_surveilled_admin_1_bar_chart_relative ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">contacts_surveilled_admin_1_bar_chart_relative</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">contacts_surveilled_admin_1_bar_chart_relative</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="contacts_surveilled_admin_1_text" class="section level2">
<h2 class="hasAnchor">
<a href="#contacts_surveilled_admin_1_text" class="anchor"></a>contacts_surveilled_admin_1_text</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ contacts_surveilled_admin_1_text ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">contacts_surveilled_admin_1_text</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">contacts_surveilled_admin_1_text</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="contacts-per-case" class="section level1">
<h1 class="hasAnchor">
<a href="#contacts-per-case" class="anchor"></a>Contacts per case</h1>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Contacts per case  -----------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Functions that output the number of contacts linked to each case At the moment (May 13, 2021), the Go.Data app version has no information for this column. ## total_contacts_per_case_donut_plot</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ total_contacts_per_case_donut_plot ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">total_contacts_per_case_donut_plot</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      
      <span class="fu">total_contacts_per_case_donut_plot</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="total_contacts_per_case_table" class="section level2">
<h2 class="hasAnchor">
<a href="#total_contacts_per_case_table" class="anchor"></a>total_contacts_per_case_table</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ total_contacts_per_case_table ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">total_contacts_per_case_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      
      <span class="fu">total_contacts_per_case_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="total_contacts_per_case_bar_chart" class="section level2">
<h2 class="hasAnchor">
<a href="#total_contacts_per_case_bar_chart" class="anchor"></a>total_contacts_per_case_bar_chart</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ total_contacts_per_case_bar_chart ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">total_contacts_per_case_bar_chart</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">total_contacts_per_case_bar_chart</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="total_contacts_per_case_text" class="section level2">
<h2 class="hasAnchor">
<a href="#total_contacts_per_case_text" class="anchor"></a>total_contacts_per_case_text</h2>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ total_contacts_per_case_text ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">total_contacts_per_case_text</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">total_contacts_per_case_text</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="contacts-per-link-type" class="section level1">
<h1 class="hasAnchor">
<a href="#contacts-per-link-type" class="anchor"></a>Contacts per link type</h1>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Contacts per link type  -----------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Functions that output the number of contacts for each type of link (e.g. family) At the moment (May 13, 2021), the Go.Data app version has no information for this column. ## total_contacts_per_link_type_donut_plot</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ total_contacts_per_link_type_donut_plot ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">total_contacts_per_link_type_donut_plot</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">total_contacts_per_link_type_donut_plot</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="total_contacts_per_link_type_bar_chart" class="section level2">
<h2 class="hasAnchor">
<a href="#total_contacts_per_link_type_bar_chart" class="anchor"></a>total_contacts_per_link_type_bar_chart</h2>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ total_contacts_per_link_type_bar_chart ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">total_contacts_per_link_type_bar_chart</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="http://jkunst.com/highcharter/reference/renderHighchart.html">renderHighchart</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">total_contacts_per_link_type_bar_chart</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="total_contacts_per_link_type_text" class="section level2">
<h2 class="hasAnchor">
<a href="#total_contacts_per_link_type_text" class="anchor"></a>total_contacts_per_link_type_text</h2>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ total_contacts_per_link_type_text ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">total_contacts_per_link_type_text</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">total_contacts_per_link_type_text</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="outputs-pertaining-to-active-contacts" class="section level1">
<h1 class="hasAnchor">
<a href="#outputs-pertaining-to-active-contacts" class="anchor"></a>OUTPUTS PERTAINING TO ACTIVE CONTACTS</h1>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ OUTPUTS PERTAINING TO ACTIVE CONTACTS ----</span>
<span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
</div>
<div id="active-contacts-bar-chart" class="section level1">
<h1 class="hasAnchor">
<a href="#active-contacts-bar-chart" class="anchor"></a>Active contacts bar chart</h1>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Active contacts bar chart  ------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Graphs showing active contacts by status ## active_contacts_breakdown_bar_chart</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_breakdown_bar_chart ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_breakdown_bar_chart</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://docs.ropensci.org/plotly/reference/plotly-shiny.html">renderPlotly</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      
      <span class="fu">active_contacts_breakdown_bar_chart</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>,
        legend_df <span class="op">=</span> <span class="va">legend_df</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="active_contacts_breakdown_table" class="section level2">
<h2 class="hasAnchor">
<a href="#active_contacts_breakdown_table" class="anchor"></a>active_contacts_breakdown_table</h2>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_breakdown_table ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_breakdown_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable-shiny.html">renderReactable</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>
      
      <span class="fu">active_contacts_breakdown_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="active_contacts_breakdown_table_download" class="section level2">
<h2 class="hasAnchor">
<a href="#active_contacts_breakdown_table_download" class="anchor"></a>active_contacts_breakdown_table_download</h2>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_breakdown_table_download ---- </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_breakdown_table_download</span> <span class="op">&lt;-</span>
    <span class="fu">active_contacts_breakdown_table_download</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="active-contacts-snake-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#active-contacts-snake-plot" class="anchor"></a>Active contacts snake plot</h1>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Active contacts snake plot  ------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>The snake plot shows the status of each active contact. The user can drag to select contacts, and download the list of selected contacts. ## active_contacts_timeline_snake_plot</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_timeline_snake_plot ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_timeline_snake_plot</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://docs.ropensci.org/plotly/reference/plotly-shiny.html">renderPlotly</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">active_contacts_timeline_snake_plot</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>,
        legend_df <span class="op">=</span> <span class="va">legend_df</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="active_contacts_snake_plot_selected_table" class="section level2">
<h2 class="hasAnchor">
<a href="#active_contacts_snake_plot_selected_table" class="anchor"></a>active_contacts_snake_plot_selected_table</h2>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_snake_plot_selected_table ----  </span>
  
  <span class="co">## table with the contacts that were selected</span>
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_snake_plot_selected_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable-shiny.html">renderReactable</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">active_contacts_snake_plot_selected_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        <span class="fu"><a href="https://docs.ropensci.org/plotly/reference/event_data.html">event_data</a></span><span class="op">(</span><span class="st">"plotly_selecting"</span><span class="op">)</span><span class="op">$</span><span class="va">customdata</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="active_contacts_snake_plot_selected_table_download" class="section level2">
<h2 class="hasAnchor">
<a href="#active_contacts_snake_plot_selected_table_download" class="anchor"></a>active_contacts_snake_plot_selected_table_download</h2>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_snake_plot_selected_table_download ----  </span>
  
  <span class="co">## download handler for the selected table</span>
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_snake_plot_selected_table_download</span> <span class="op">&lt;-</span>
    <span class="fu">active_contacts_snake_plot_selected_table_download</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="active_contacts_timeline_table" class="section level2">
<h2 class="hasAnchor">
<a href="#active_contacts_timeline_table" class="anchor"></a>active_contacts_timeline_table</h2>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_timeline_table ----  </span>
  
  <span class="co">## This is the tabular version of the data shown with the bar chart</span>
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_timeline_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable-shiny.html">renderReactable</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">active_contacts_timeline_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="active_contacts_timeline_table_download" class="section level2">
<h2 class="hasAnchor">
<a href="#active_contacts_timeline_table_download" class="anchor"></a>active_contacts_timeline_table_download</h2>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_timeline_table_download ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_timeline_table_download</span> <span class="op">&lt;-</span>
    <span class="fu">active_contacts_timeline_table_download</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="active_contacts_timeline_text" class="section level2">
<h2 class="hasAnchor">
<a href="#active_contacts_timeline_text" class="anchor"></a>active_contacts_timeline_text</h2>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ active_contacts_timeline_text ----  </span>
  
  <span class="co">## text highlighting the number of active contacts</span>
  <span class="va">output</span><span class="op">$</span><span class="va">active_contacts_timeline_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

    <span class="fu">active_contacts_timeline_text</span><span class="op">(</span>
      contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
      todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="contacts-lost-to-follow-up" class="section level1">
<h1 class="hasAnchor">
<a href="#contacts-lost-to-follow-up" class="anchor"></a>Contacts lost to follow-up</h1>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># ~ Contacts lost to follow-up  ------</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></code></pre></div>
<p>Tables (and their download handlers) summarizing the number of individuals lost to follow-up ## contacts_lost_24_to_72_hours_table</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ contacts_lost_24_to_72_hours_table ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">contacts_lost_24_to_72_hours_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/gt/man/render_gt.html">render_gt</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">contacts_lost_24_to_72_hours_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
<div id="contacts_lost_24_to_72_hours_table_download" class="section level2">
<h2 class="hasAnchor">
<a href="#contacts_lost_24_to_72_hours_table_download" class="anchor"></a>contacts_lost_24_to_72_hours_table_download</h2>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ contacts_lost_24_to_72_hours_table_download ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">contacts_lost_24_to_72_hours_table_download</span> <span class="op">&lt;-</span>
    <span class="fu">contacts_lost_24_to_72_hours_table_download</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="lost_contacts_linelist_table" class="section level2">
<h2 class="hasAnchor">
<a href="#lost_contacts_linelist_table" class="anchor"></a>lost_contacts_linelist_table</h2>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ lost_contacts_linelist_table ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">lost_contacts_linelist_table</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable-shiny.html">renderReactable</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">lost_contacts_linelist_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="va">.</span><span class="op">$</span><span class="va">output_table</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="lost_contacts_linelist_table_download" class="section level2">
<h2 class="hasAnchor">
<a href="#lost_contacts_linelist_table_download" class="anchor"></a>lost_contacts_linelist_table_download</h2>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ lost_contacts_linelist_table_download ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">lost_contacts_linelist_table_download</span> <span class="op">&lt;-</span>
    <span class="fu">lost_contacts_linelist_table_download</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="lost_contacts_linelist_table_title" class="section level2">
<h2 class="hasAnchor">
<a href="#lost_contacts_linelist_table_title" class="anchor"></a>lost_contacts_linelist_table_title</h2>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ lost_contacts_linelist_table_title ----  </span></code></pre></div>
<p>The title needs to be dynamic because at database inception, there may only be one or two days of follow-up in total. In such cases, we cannot call the table "number lost to follow-up over the past three days</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">output</span><span class="op">$</span><span class="va">lost_contacts_linelist_table_title</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

      <span class="fu">lost_contacts_linelist_table</span><span class="op">(</span>
        contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
        todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
      <span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="va">.</span><span class="op">$</span><span class="va">table_title</span>
    <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="lost_contacts_linelist_text" class="section level2">
<h2 class="hasAnchor">
<a href="#lost_contacts_linelist_text" class="anchor"></a>lost_contacts_linelist_text</h2>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~ lost_contacts_linelist_text ----  </span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">lost_contacts_linelist_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span><span class="op">)</span>

    <span class="fu">lost_contacts_linelist_text</span><span class="op">(</span>
      contacts_df_long <span class="op">=</span> <span class="fu">read_file_filtered_reactive</span><span class="op">(</span><span class="op">)</span>,
      todays_date <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_date_of_review</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kene David Nwosu.</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1, using <a href="https://preferably.amirmasoudabdol.name/?source=footer">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
